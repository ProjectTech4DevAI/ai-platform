[request_definition]
r = sub, org, proj, obj, act

[policy_definition]
p = role, obj, act

[role_definition]
g = _, _, _   # user → role → org
g2 = _, _, _  # user → role → project

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# Matcher logic:
# - If project ID is not present → check org-level role (g).
# - If project ID is present:
#   - Check if user has equivalent org-level role (e.g., org_admin → project_admin).
#   - Otherwise, fall back to project-level role check (g2).
# Final match only happens if object and action match as well.

m = ((r.proj == "" && g(r.sub, p.role, r.org)) || (r.proj != "" && (g(r.sub, "org_admin", r.org) && p.role == "project_admin" || g(r.sub, "org_manager", r.org) && p.role == "project_manager" || g(r.sub, "org_reader", r.org) && p.role == "project_reader" || g2(r.sub, p.role, r.proj)))) && r.obj == p.obj && r.act == p.act
